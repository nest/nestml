{#
  Generates a series of statements which perform one integration step of all ODEs defined the neuron.
#}
{%- if tracing %}# generated by {{self._TemplateReference__context.name}}{% endif %}
{%- if numeric_solver == "rk45" %}
res = scipy.integrate.solve_ivp(Neuron_{{neuronName}}.dynamics, t_span=(origin, origin + timestep), y0=self.S_.ode_state, method="RK45", args=(self, ))
np.testing.assert_almost_equal(res.t[-1], origin + timestep)   # sanity check on the final timestep reached by the solver
self.S_.ode_state = res.y[:, -1]
{%- else %}
{{ raise('Unsupported numerical solver') }}
{%- endif %}
