{#
  Generates a series of C statements which perform one integration step of
  all odes defined the neuron.
#}
{%- if tracing %}/* generated by {{self._TemplateReference__context.name}} */ {% endif %}
// numerical integration with fixed step size, either rk4 or forward euler:
// ------------------------------------------------------
        REAL y_old[{{ numeric_state_variables | length }}];
    {% for declaration in neuron.get_state_declarations() %}
        {% if declaration.get_variables()[0].name == "I_syn_exc" %}
        y_old[{{ loop.index0 }}] = {{ printer.print(declaration.get_variables()[0]) }} + I_syn_exc_IN;
        {% elif declaration.get_variables()[0].name == "I_syn_inh"%}
        y_old[{{ loop.index0 }}] = {{ printer.print(declaration.get_variables()[0]) }} + I_syn_inh_IN;
        {% else %}
        y_old[{{ loop.index0 }}] = {{ printer.print(declaration.get_variables()[0]) }};
        {% endif %}
    {% endfor %}
        REAL y_new[{{ numeric_state_variables | length }}];
{%- if numeric_solver == "rk45" %}
        rk4_step({{ neuronName }}_rhs, (REAL)systicks, y_old,
                           global_neuron_params.calc_step_raw, {{ numeric_state_variables |length }}, neuron, y_new);

    {% for declaration in neuron.get_state_declarations() %}
        {{ printer.print(declaration.get_variables()[0]) }} = y_new[{{ loop.index0 }}];
    {% endfor %}


{%- elif numeric_solver == "forward-Euler" %}
        forward_euler_step({{ neuronName }}_rhs, (REAL)systicks, y_old,
                           global_neuron_params.calc_step_raw, {{ numeric_state_variables |length }}, neuron, y_new);

    {% for declaration in neuron.get_state_declarations() %}
        {{ printer.print(declaration.get_variables()[0]) }} = y_new[{{ loop.index0 }}];
    {% endfor %}
{%- else %}
{{ raise('Unknown numeric ODE solver requested.') }}
{%- endif %}
